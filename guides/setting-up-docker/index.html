<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.5">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DB2BZPKYN9"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-DB2BZPKYN9",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="AutoPi Documentation" href="/opensearch.xml"><title data-react-helmet="true">Setting up Docker on your device | AutoPi Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://docs.autopi.io/img/favicon-194x194.png"><meta data-react-helmet="true" name="twitter:image" content="https://docs.autopi.io/img/favicon-194x194.png"><meta data-react-helmet="true" property="og:url" content="https://docs.autopi.io/guides/setting-up-docker/"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:type" content="website"><meta data-react-helmet="true" property="og:title" content="Setting up Docker on your device | AutoPi Documentation"><meta data-react-helmet="true" name="description" content="Overview"><meta data-react-helmet="true" property="og:description" content="Overview"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.autopi.io/guides/setting-up-docker/"><link data-react-helmet="true" rel="alternate" href="https://docs.autopi.io/guides/setting-up-docker/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.autopi.io/guides/setting-up-docker/" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://7BRH96O31B-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.71bb87a7.css">
<link rel="preload" href="/assets/js/runtime~main.66b99b25.js" as="script">
<link rel="preload" href="/assets/js/main.86a74cd4.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo_trans_doc.png" alt="AutoPi Documentation Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo_trans_doc_dark.png" alt="AutoPi Documentation Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link" href="/cloud/cloud-intro/">Cloud</a><a class="navbar__item navbar__link" href="/core/core-intro/">Core</a><a class="navbar__item navbar__link" href="/hardware/hardware-intro/">Hardware</a><a class="navbar__item navbar__link" href="/guides/guides-intro/">Guides</a><a href="https://api.autopi.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/guides/guides-intro/">Getting started</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">API</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Business</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">OBD-II</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Services</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/4g-internet-setup-troubleshooting/">4G internet setup troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/a-guide-to-triggers/">A guide to Triggers</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/adding-a-new-widget-from-scratch/">Adding a New Widget from Scratch</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/autopi-logs/">AutoPi Logs</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/configuring-mqtt/">Configuring MQTT</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/enabling_bluetooth_on_TMU_devices/">Enabling Bluetooth on Devices With STN Chips</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/how-to-ssh-to-your-device/">How to SSH to your device</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/installing-a-camera-on-your-autopi/">Installing a Camera on Your AutoPi</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/j1939-getting-started-guide/">J1939 Getting Started Guide</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/jumpers/">Jumpers</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/local-development-workflow/">Local Development Workflow</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/power-cycle-for-electric-vehicles/">Power Cycle for Electric Vehicles</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/reflashing-your-device/">Reflashing your device</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/remotely-waking-up-your-device/">Remotely waking up your device</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/rfid-integartion/">RFID Reader Integration</a></li><li class="menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/guides/setting-up-docker/">Setting up Docker on your device</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/setting-up-our-device-with-verizon-wireless/">Setting up our device with Verizon Wireless</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/upgrading-your-raspberry-pi/">Upgrade/Replace Your Raspberry Pi Computer</a></li><li class="menu__list-item"><a class="menu__link" href="/guides/using-the-autopi-with-an-external-power-supply/">Using the AutoPi with an external power supply</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1>Setting up Docker on your device</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="deploying-docker-containers-on-devices"></a>Deploying docker containers on devices<a class="hash-link" href="#deploying-docker-containers-on-devices" title="Direct link to heading">#</a></h3><p>  <strong>1.	Create the release. </strong></p><p>  The way this will work is that a Release endpoint will be implemented where each release will contain the following information</p><ul><li><p>Version</p></li><li><p>Which devices the release applies to</p></li><li><p>A number of containers each with the following information</p><ul><li>Name</li><li>Which image+tag to run</li><li>Which tags should be present on the device</li><li>Startup parameters</li><li>If data directories should be purged on deploy.</li></ul><p>This endpoint will return success when the release is created.</p></li></ul><p><strong>2.	The update will then be queued on each referenced device.</strong></p><p>  This will cause the device to retrieve the active release associated to it, and perform the following actions.</p><p><img alt="Docker state flow" src="/assets/images/docker_flow-deebcf7223260c08a16a4d49b48eb398.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="endpoints"></a>Endpoints<a class="hash-link" href="#endpoints" title="Direct link to heading">#</a></h2><p>The CRUD endpoints all return “201 Created” or “200 OK” when an entity is created or modified, and the body of the response will contain the created or modified entity.
The DELETE method will return “204 No content” on success.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="registry"></a>Registry<a class="hash-link" href="#registry" title="Direct link to heading">#</a></h3><p>A registry should be created to allow the device to authenticate against a custom docker registry.
The model contains the url and credentials for the custom docker registry.
When added, devices will automatically log in to the registry if not already logged in, on startup, and thereby be ready to pull images.</p><p>If the image should be pulled through a custom registry, the registry needs to be referenced when creating the container.</p><p>Creating a registry is done using this endpoint
<a href="https://api.autopi.io/#/docker/docker_registries_create" target="_blank" rel="noopener noreferrer">https://api.autopi.io/#/docker/docker_registries_create</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="project"></a>Project<a class="hash-link" href="#project" title="Direct link to heading">#</a></h3><p>The project endpoint is a wrapper for releases, so to create any releases you must first create a project.</p><p>Creating a project is done using this endpoint</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">POST /docker/projects/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><a href="https://api.autopi.io/#/docker/docker_projects_create" target="_blank" rel="noopener noreferrer">https://api.autopi.io/#/docker/docker_projects_create</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="release"></a>Release<a class="hash-link" href="#release" title="Direct link to heading">#</a></h3><p>The release endpoint is used to create new releases, and contains a list of containers each with metadata and runtime properties for that specific container.</p><p>Creating a project is done using this nested endpoint</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">POST /docker/projects/{project_pk}/releases/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><a href="https://api.autopi.io/#/docker/docker_projects_releases_create" target="_blank" rel="noopener noreferrer">https://api.autopi.io/#/docker/docker_projects_releases_create</a></p><p>Payload</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   &quot;id&quot;: 1,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   &quot;version&quot;: &quot;1.0.0&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   &quot;version_hash&quot;: &quot;96a7191f&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   &quot;devices&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;device_id&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   &quot;containers&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;name&quot;: &quot;curveball&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;image&quot;: &quot;curveball&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;tag&quot;: &quot;delta-base-r0.0.0.1&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;required_tags&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;base&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           ],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;startup_parameters&quot;: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;environment&quot;: &quot;REQUESTS_CA_BUNDLE=&#x27;/usr/local/share/ca-certificates/AdamCA.crt&#x27;&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;binds&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                   &quot;/home/balenaEngine/data:/opt/RavenDB/Server/RavenData&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               ],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;network_mode&quot;: &quot;host&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;restart_policy&quot;: &quot;always&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;privileged&quot;: true</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;purge_data&quot;: false,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;registry&quot;: 1,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;fully_qualified_name&quot;: &quot;deployment-curveball-1&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;name&quot;: &quot;ravendb&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;image&quot;: &quot;ravendb&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;tag&quot;: &quot;base&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;required_tags&quot;: [],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;startup_parameters&quot;: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;environment&quot;: &quot;RAVEN_ARGS=&#x27;--config-path /opt/RavenDB/Server/RavenData/settings.json&#x27;&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;binds&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                   &quot;/home/balenaEngine/data:/opt/RavenDB/Server/RavenData&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               ],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;network_mode&quot;: &quot;host&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;restart_policy&quot;: &quot;always&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;privileged&quot;: true</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;purge_data&quot;: false,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;registry&quot;: 1,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;fully_qualified_name&quot;: &quot;deployment-ravendb-1&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   &quot;successful_deployments&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;device_id&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   &quot;remove_containers&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;curveball&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;ravendb&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="special-fields"></a>Special Fields<a class="hash-link" href="#special-fields" title="Direct link to heading">#</a></h4><table><thead><tr><th align="center"><strong>Name</strong></th><th><strong>Required</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td align="center">remove_containers</td><td>No</td><td>Explicitly names the containers which should be handled as ‘initial containers’. On release it will attempt to stop each container, run deployment, and if successful the containers will be removed, or on failure, they will be restarted.</td></tr><tr><td align="center">version_hash</td><td>Readonly</td><td>Alternative autogenerated field (readonly) only used for referencing a release by a generated version.</td></tr><tr><td align="center">successful_deployments</td><td>Readonly</td><td>Will include only devices which has successfully deployed the release.</td></tr></tbody></table><p>After a release is created, each device associated to the release will receive the release information, and the release will be applied the next time the device is about to go to sleep, as the device in that situation is considered to be idle. Logging in to registries, removing images, pulling new images, starting containers etc.</p><p>The release can also be triggered by executing the following command via the execute endpoint on the devices you want to deploy to.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">state.sls docker.release</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="device"></a>Device<a class="hash-link" href="#device" title="Direct link to heading">#</a></h3><p>The device endpoints can be used to retrieve either all devices, or some devices, and includes a new field called docker_releases which can be used to see if a specific release is deployed successfully on the device. The ID is the ID of the release.</p><p>Get a specific device
<a href="https://api.autopi.io/#/dongle/dongle_devices_read" target="_blank" rel="noopener noreferrer">https://api.autopi.io/#/dongle/dongle_devices_read</a></p><p>Get all devices
<a href="https://api.autopi.io/#/dongle/dongle_devices_list" target="_blank" rel="noopener noreferrer">https://api.autopi.io/#/dongle/dongle_devices_list</a></p><p>Both endpoints returns device object(s)</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;id&quot;: &quot;734c361a-ba56-472a-a891-ee2af1a8057v&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;unit_id&quot;: &quot;4e633880-ef6e-4c20-77ed-5761b3de5d4c&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;docker_releases&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    103</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="modules"></a>Modules<a class="hash-link" href="#modules" title="Direct link to heading">#</a></h2><p>Highlighted modules for performing various actions on a running device docker instance.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="executing-module-commands"></a>Executing module commands<a class="hash-link" href="#executing-module-commands" title="Direct link to heading">#</a></h3><p>Module commands is executed on the device through the execute endpoint.
See documentation here: <a href="https://api.autopi.io/#/dongle/dongle_devices_execute_command" target="_blank" rel="noopener noreferrer">https://api.autopi.io/#/dongle/dongle_devices_execute_command</a></p><p>When executing commands remotely, you must execute the command async via the execute endpoint, and then use the <a href="https://api.autopi.io/#/dongle/dongle_devices_retrieve_command_result" target="_blank" rel="noopener noreferrer">https://api.autopi.io/#/dongle/dongle_devices_retrieve_command_result</a> endpoint to poll for the result from the device.</p><p>Example payloads for REST API are included below.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="executing-commands-locally-on-the-device"></a>Executing commands locally on the device<a class="hash-link" href="#executing-commands-locally-on-the-device" title="Direct link to heading">#</a></h4><p>The above commands can also be executed directly on the device with the following endpoint</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">POST localhost:9000/dongle/&lt;uuid:unit_id&gt;/execute/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The body should be the same as the above remote command endpoint.</p><p>The unit_id can be retrieved one of the following ways </p><p>A.	Calling the root route</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GET localhost:9000</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>B.	Reading it from the file </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/etc/salt/minion_id</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The reason that you need the unit_id is because we need to make sure that the request is actually meant for that specific device when using the endpoint from another connected device, like when using the local configuration tool.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="container-logs"></a>Container Logs<a class="hash-link" href="#container-logs" title="Direct link to heading">#</a></h3><p>Logs are retrieved from the containers by using the docker module.</p><p>docker.logs CONTAINER_NAME</p><p>Example payload for executing via REST API</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;command&quot;: &quot;docker.logs&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;arg&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;CONTAINER_NAME&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;kwarg&quot;: {}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>5.3. Device Logs
Logs are retrieved from the device by using the minionutil module.</p><p>minionutil.last_logs</p><p>See documentation site for all parameters
<a href="/core/commands/core-commands-minionutil/#minionutillast_logs"><code>minionutil.last_logs</code></a></p><p>Example payload for executing via REST API</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;command&quot;: &quot;minionutil.last_logs&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;arg&quot;: [],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;kwarg&quot;: {}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="production-environment"></a>Production environment<a class="hash-link" href="#production-environment" title="Direct link to heading">#</a></h2><p>The production environment is located at: my.autopi.io</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="rest-api"></a>REST API<a class="hash-link" href="#rest-api" title="Direct link to heading">#</a></h3><p>The API can be accessed here api.autopi.io along with the API documentation.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="authenticate-using-api-token"></a>Authenticate using API token<a class="hash-link" href="#authenticate-using-api-token" title="Direct link to heading">#</a></h4><p>Authentication should be done with the API tokens.
These tokens can be generated in the account page. The expire date is optional.
The tokens can then be used in external systems to authenticate the requests.
To use the token, you simply set the Authorization header to the following value, when sending HTTP requests to the API.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Authorization: APIToken ******</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="telemetry-data-examples"></a>Telemetry Data Examples<a class="hash-link" href="#telemetry-data-examples" title="Direct link to heading">#</a></h4><p>Accessing data from a device is done by calling the logbook endpoint.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor anchor__h5 anchorWithStickyNavbar_31ik" id="logbook-storage-read-parameters"></a>Logbook Storage Read Parameters<a class="hash-link" href="#logbook-storage-read-parameters" title="Direct link to heading">#</a></h5><p><strong>device_id:</strong> ID of the device you want to retrieve data from.
<strong>field:</strong> Name of the field you want to retrieve the value from.
<strong>field_type:</strong> type of the field
<strong>from_utc:</strong> ISO Datetime string
<strong>to_utc:</strong> ISO Datetime string
<strong>aggregation:</strong> Aggregation method (AVG, MIN, MAX, SUM)
<strong>interval:</strong> Data is aggregated based on the aggregation method specified, the interval specifies how many groups the data is grouped into. For example, getting data for a 10 hour period, with the interval set to 1h, you will get back 10 values, one value per hour.</p><p>Getting positions</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GET /logbook/storage/read/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">?device_id=DEVICE_ID</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&amp;field=track.pos.loc</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&amp;field_type=geo_point</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&amp;from_utc=2020-01-01T00:00:00.000Z</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&amp;to_utc=2020-01-01T01:00:00.000Z</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Example response</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;ts&quot;: &quot;2020-07-09T10:11:53.811839Z&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;location&quot;: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    &quot;lat&quot;: 57.04699,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    &quot;lon&quot;: 9.93909</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;ts&quot;: &quot;2020-07-09T10:11:59.248421Z&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;location&quot;: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    &quot;lat&quot;: 57.04697,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    &quot;lon&quot;: 9.93808</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Battery Voltage readings</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GET /logbook/storage/read/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">?device_id=DEVICE_ID</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&amp;field=obd.bat.voltage</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&amp;field_type=float</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&amp;aggregation=avg</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&amp;from_utc=2020-01-01T00:00:00.000Z</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&amp;to_utc=2020-01-01T01:00:00.000Z</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&amp;interval=10m</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Example response</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;max_ts&quot;: 1594289021415,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;ts&quot;: &quot;2020-07-09T10:03:37.566Z&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;value&quot;: 13.5</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;max_ts&quot;: 1594289026525,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;ts&quot;: &quot;2020-07-09T10:13:45.378Z&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;value&quot;: 13.600000381469727</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="docusaurus-mt-lg"><div class="row"><div class="col"><a href="https://github.com/autopi-io/documentation/edit/master/docs/guides/setting_up_docker.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/guides/rfid-integartion/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« RFID Reader Integration</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/guides/setting-up-our-device-with-verizon-wireless/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Setting up our device with Verizon Wireless »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a><ul><li><a href="#deploying-docker-containers-on-devices" class="table-of-contents__link">Deploying docker containers on devices</a></li></ul></li><li><a href="#endpoints" class="table-of-contents__link">Endpoints</a><ul><li><a href="#registry" class="table-of-contents__link">Registry</a></li><li><a href="#project" class="table-of-contents__link">Project</a></li><li><a href="#release" class="table-of-contents__link">Release</a></li><li><a href="#device" class="table-of-contents__link">Device</a></li></ul></li><li><a href="#modules" class="table-of-contents__link">Modules</a><ul><li><a href="#executing-module-commands" class="table-of-contents__link">Executing module commands</a></li><li><a href="#container-logs" class="table-of-contents__link">Container Logs</a></li></ul></li><li><a href="#production-environment" class="table-of-contents__link">Production environment</a><ul><li><a href="#rest-api" class="table-of-contents__link">REST API</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">AutoPi.io</div><ul class="footer__items"><li class="footer__item"><a href="https://www.autopi.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">AutoPi.io</a></li><li class="footer__item"><a href="https://my.autopi.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">My AutoPi Cloud</a></li><li class="footer__item"><a href="https://shop.autopi.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Shop</a></li><li class="footer__item"><a href="https://docs.autopi.io/search/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Search Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://community.autopi.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>AutoPi Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/autopi-io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub - AutoPi Core<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a href="https://www.reddit.com/r/autopi/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Reddit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/autopi_io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.facebook.com/autopi.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/autopi.io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCH50VR17emPVVfnIWlGMLig" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Youtube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 AutoPi.io.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.66b99b25.js"></script>
<script src="/assets/js/main.86a74cd4.js"></script>
</body>
</html>