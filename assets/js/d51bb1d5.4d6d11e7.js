"use strict";(self.webpackChunkdocumentation_2=self.webpackChunkdocumentation_2||[]).push([[1753],{28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>a});var r=n(96540);const l={},i=r.createContext(l);function s(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),r.createElement(i.Provider,{value:t},e.children)}},29521:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>h,default:()=>j,frontMatter:()=>d,metadata:()=>r,toc:()=>x});const r=JSON.parse('{"id":"core/power_management/core-power-low","title":"Low-level","description":"SPM","source":"@site/docs/core/power_management/low_level.md","sourceDirName":"core/power_management","slug":"/core/power_management/core-power-low","permalink":"/core/power_management/core-power-low","draft":false,"unlisted":false,"editUrl":"https://github.com/autopi-io/documentation/edit/master/docs/core/power_management/low_level.md","tags":[],"version":"current","frontMatter":{"id":"core-power-low","title":"Low-level"},"sidebar":"sidebar","previous":{"title":"High-level","permalink":"/core/power_management/core-power-high"},"next":{"title":"Sleep Timers","permalink":"/core/power_management/core-power-sleep-timers"}}');var l,i=n(74848),s=n(28453),a=n(96540);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(null,arguments)}const o=e=>{let{title:t,titleId:n,...r}=e;return a.createElement("svg",c({xmlns:"http://www.w3.org/2000/svg",width:"293pt",height:"260pt",viewBox:"0 0 293 260","aria-labelledby":n},r),t?a.createElement("title",{id:n},t):null,l||(l=a.createElement("g",{className:"graph",transform:"translate(4 256)"},a.createElement("title",null,"States"),a.createElement("path",{fill:"#fff",stroke:"#fff",d:"M-4 5v-261h294V5z"}),a.createElement("g",{className:"node"},a.createElement("title",null,"OFF"),a.createElement("ellipse",{cx:159,cy:-234,fill:"none",stroke:"#000",rx:28.616,ry:18}),a.createElement("text",{x:159,y:-229.8,fontFamily:"Times,serif",fontSize:14,textAnchor:"middle"},a.createElement("a",null,"OFF"))),a.createElement("g",{className:"node"},a.createElement("title",null,"BOOTING"),a.createElement("ellipse",{cx:159,cy:-162,fill:"none",stroke:"#000",rx:54.215,ry:18}),a.createElement("text",{x:159,y:-157.8,fontFamily:"Times,serif",fontSize:14,textAnchor:"middle"},a.createElement("a",null,"BOOTING"))),a.createElement("g",{className:"edge"},a.createElement("title",null,"OFF->BOOTING"),a.createElement("path",{fill:"none",stroke:"#000",d:"M153.122-216.055c-.818 7.709-1.061 17.028-.727 25.691"}),a.createElement("path",{stroke:"#000",d:"m155.894-190.491-2.807 10.216-4.176-9.737z"})),a.createElement("g",{className:"node"},a.createElement("title",null,"HIBERNATING"),a.createElement("ellipse",{cx:77,cy:-18,fill:"none",stroke:"#000",rx:77.003,ry:18}),a.createElement("text",{x:77,y:-13.8,fontFamily:"Times,serif",fontSize:14,textAnchor:"middle"},a.createElement("a",null,"HIBERNATING"))),a.createElement("g",{className:"edge"},a.createElement("title",null,"OFF->HIBERNATING"),a.createElement("path",{fill:"none",stroke:"#000",d:"M138.377-221.459C123.962-212.218 105.631-197.866 96-180 73.102-137.525 72.352-79.732 74.355-46.188"}),a.createElement("path",{stroke:"#000",d:"M77.847-46.426 75.077-36.2l-4.212-9.721z"})),a.createElement("g",{className:"edge"},a.createElement("title",null,"BOOTING->OFF"),a.createElement("path",{fill:"none",stroke:"#000",d:"M164.913-180.275c.802-7.755 1.027-17.087.678-25.73"}),a.createElement("path",{stroke:"#000",d:"m162.094-205.832 2.784-10.223 4.199 9.728z"})),a.createElement("g",{className:"node"},a.createElement("title",null,"ON"),a.createElement("ellipse",{cx:225,cy:-90,fill:"none",stroke:"#000",rx:27,ry:18}),a.createElement("text",{x:225,y:-85.8,fontFamily:"Times,serif",fontSize:14,textAnchor:"middle"},a.createElement("a",null,"ON"))),a.createElement("g",{className:"edge"},a.createElement("title",null,"BOOTING->ON"),a.createElement("path",{fill:"none",stroke:"#000",d:"m174.641-144.411 29.669 31.467"}),a.createElement("path",{stroke:"#000",d:"m206.949-115.247 4.313 9.677-9.407-4.875z"})),a.createElement("g",{className:"edge"},a.createElement("title",null,"HIBERNATING->BOOTING"),a.createElement("path",{fill:"none",stroke:"#000",d:"m86.972-36.268 57.298-99.224"}),a.createElement("path",{stroke:"#000",d:"m141.24-137.244 8.032-6.909-1.97 10.41z"})),a.createElement("g",{className:"edge"},a.createElement("title",null,"ON->OFF"),a.createElement("path",{fill:"none",stroke:"#000",d:"M228.36-108.046c2.816-18.672 4.794-49.013-6.36-71.954-7.211-14.831-20.718-27.059-33.382-36.018"}),a.createElement("path",{stroke:"#000",d:"m186.469-213.243-6.396-8.446 10.267 2.614z"})),a.createElement("g",{className:"edge"},a.createElement("title",null,"ON->HIBERNATING"),a.createElement("path",{fill:"none",stroke:"#000",d:"m203.48-78.821-84.955 40.18"}),a.createElement("path",{stroke:"#000",d:"m120.013-35.472-10.537 1.112 7.544-7.44z"})),a.createElement("g",{className:"node"},a.createElement("title",null,"SLEEPING"),a.createElement("ellipse",{cx:229,cy:-18,fill:"none",stroke:"#000",rx:56.443,ry:18}),a.createElement("text",{x:229,y:-13.8,fontFamily:"Times,serif",fontSize:14,textAnchor:"middle"},a.createElement("a",null,"SLEEPING"))),a.createElement("g",{className:"edge"},a.createElement("title",null,"ON->SLEEPING"),a.createElement("path",{fill:"none",stroke:"#000",d:"m225.989-71.697 1.462 25.585"}),a.createElement("path",{stroke:"#000",d:"m230.946-46.288-2.923 10.184-4.065-9.784z"})),a.createElement("g",{className:"edge"},a.createElement("title",null,"SLEEPING->BOOTING"),a.createElement("path",{fill:"none",stroke:"#000",d:"M214.167-35.714C205.89-45.702 195.89-58.952 189-72c-10.438-19.767-18.3-43.887-23.351-62.028"}),a.createElement("path",{stroke:"#000",d:"m162.2-133.376.801-10.565 5.962 8.758z"})))))},d={id:"core-power-low",title:"Low-level"},h=void 0,m={},x=[{value:"SPM",id:"spm",level:2},{value:"States",id:"states",level:3},{value:"OFF",id:"off",level:4},{value:"Transitions",id:"transitions",level:5},{value:"BOOTING",id:"booting",level:4},{value:"Transitions",id:"transitions-1",level:5},{value:"ON",id:"on",level:4},{value:"Transitions",id:"transitions-2",level:5},{value:"SLEEPING",id:"sleeping",level:4},{value:"Transitions",id:"transitions-3",level:5},{value:"HIBERNATING",id:"hibernating",level:4},{value:"Transitions",id:"transitions-4",level:5},{value:"STN",id:"stn",level:2}];function p(e){const t={a:"a",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"spm",children:"SPM"}),"\n",(0,i.jsx)(t.p,{children:"The SPM (Smart Power Management) is an embedded system that controls the low-level power cycle of the device. It interacts with a number of subsystems that can initiate power state changes:"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Subsystem"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Accelerometer"}),(0,i.jsx)(t.td,{children:"Built-in accelerometer is capable of triggering wake up based on physical movement events."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Modem"}),(0,i.jsx)(t.td,{children:"Installed modem module can trigger wake up on received SMS or dial up call."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"#stn",children:"STN"})}),(0,i.jsx)(t.td,{children:"Built-in chipset triggers power on and off based on voltage level changes."})]})]})]}),"\n",(0,i.jsxs)(t.p,{children:["Finally the Raspberry Pi communicates directly with the SPM and performs power state changes based on more ",(0,i.jsx)(t.a,{href:"/core/power_management/core-power-high",children:"high-level"})," decisions."]}),"\n",(0,i.jsx)(t.h3,{id:"states",children:"States"}),"\n",(0,i.jsx)(t.p,{children:"Below diagram shows an overview of all possible SPM states and the transitions between."}),"\n","\n",(0,i.jsx)(o,{}),"\n",(0,i.jsx)(t.h4,{id:"off",children:"OFF"}),"\n",(0,i.jsx)(t.p,{children:"Everything is powered off."}),"\n",(0,i.jsx)(t.h5,{id:"transitions",children:"Transitions"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"State"}),(0,i.jsx)(t.th,{children:"Condition"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"#booting",children:"BOOTING"})}),(0,i.jsx)(t.td,{children:"The device is plugged in."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"#hibernating",children:"HIBERNATING"})}),(0,i.jsx)(t.td,{children:"Maximum number of boot attempts reached. Default is 10 attempts."})]})]})]}),"\n",(0,i.jsx)(t.h4,{id:"booting",children:"BOOTING"}),"\n",(0,i.jsx)(t.p,{children:"Everything is powered on and the Raspberry Pi is booting up."}),"\n",(0,i.jsx)(t.h5,{id:"transitions-1",children:"Transitions"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"State"}),(0,i.jsx)(t.th,{children:"Condition"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"#on",children:"ON"})}),(0,i.jsx)(t.td,{children:"Successfully communicated with the Raspberry Pi."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"#off",children:"OFF"})}),(0,i.jsx)(t.td,{children:"No communication with the Raspberry Pi within a given time limit. Default boot timeout is 10 minutes."})]})]})]}),"\n",(0,i.jsx)(t.h4,{id:"on",children:"ON"}),"\n",(0,i.jsx)(t.p,{children:"Everything is powered on and there is regular communication with the Raspberry Pi."}),"\n",(0,i.jsx)(t.h5,{id:"transitions-2",children:"Transitions"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"State"}),(0,i.jsx)(t.th,{children:"Condition"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"#sleeping",children:"SLEEPING"})}),(0,i.jsx)(t.td,{children:"The Raspberry Pi decided to sleep for a given period of time."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"#hibernating",children:"HIBERNATING"})}),(0,i.jsx)(t.td,{children:"The Raspberry Pi decided to hibernate or the STN chip powered off according to its triggers."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"#off",children:"OFF"})}),(0,i.jsx)(t.td,{children:"No communication with the Raspberry Pi within a given time limit. Default heartbeat timeout is 3 minutes."})]})]})]}),"\n",(0,i.jsx)(t.h4,{id:"sleeping",children:"SLEEPING"}),"\n",(0,i.jsx)(t.p,{children:"The Raspberry Pi is powered off. Modem and GPS is kept on in low power mode."}),"\n",(0,i.jsx)(t.p,{children:"Wake up will happen after a specified period of sleep time or earlier if:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"STN is powered on."}),"\n",(0,i.jsx)(t.li,{children:"Received wake signal from modem."}),"\n",(0,i.jsx)(t.li,{children:"Received wake signal from accelerometer."}),"\n"]}),"\n",(0,i.jsx)(t.h5,{id:"transitions-3",children:"Transitions"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"State"}),(0,i.jsx)(t.th,{children:"Condition"})]})}),(0,i.jsx)(t.tbody,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"#booting",children:"BOOTING"})}),(0,i.jsx)(t.td,{children:"See the above criteria."})]})})]}),"\n",(0,i.jsx)(t.h4,{id:"hibernating",children:"HIBERNATING"}),"\n",(0,i.jsx)(t.p,{children:"Everything is shut down for maximum power saving."}),"\n",(0,i.jsx)(t.h5,{id:"transitions-4",children:"Transitions"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"State"}),(0,i.jsx)(t.th,{children:"Condition"})]})}),(0,i.jsx)(t.tbody,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"#booting",children:"BOOTING"})}),(0,i.jsx)(t.td,{children:"The STN powers on (when transitions from off to on)."})]})})]}),"\n",(0,i.jsx)(t.h2,{id:"stn",children:"STN"}),"\n",(0,i.jsxs)(t.p,{children:["See the STN command for available power trigger options ",(0,i.jsx)(t.a,{href:"/core/commands/core-commands-stn",children:"here"}),"."]})]})}function j(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}}}]);