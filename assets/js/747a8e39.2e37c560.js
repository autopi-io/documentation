"use strict";(self.webpackChunkdocumentation_2=self.webpackChunkdocumentation_2||[]).push([[5371],{17576:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>s,default:()=>c,frontMatter:()=>l,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"core/power_management/core-power-intro","title":"Introduction","description":"For power cycle, LED and button information on the AutoPi TMU CM4, please see configuration here","source":"@site/docs/core/power_management/index.md","sourceDirName":"core/power_management","slug":"/core/power_management/","permalink":"/core/power_management/","draft":false,"unlisted":false,"editUrl":"https://github.com/autopi-io/documentation/edit/master/docs/core/power_management/index.md","tags":[],"version":"current","frontMatter":{"id":"core-power-intro","title":"Introduction"},"sidebar":"sidebar","previous":{"title":"Wifi","permalink":"/core/commands/core-commands-wifi"},"next":{"title":"High-level","permalink":"/core/power_management/core-power-high"}}');var r=n(74848),o=n(28453);const l={id:"core-power-intro",title:"Introduction"},s=void 0,a={},h=[{value:"Power Cycle",id:"power-cycle",level:2},{value:"On",id:"on",level:4},{value:"Sleeping",id:"sleeping",level:4},{value:"Hibernating",id:"hibernating",level:4},{value:"Walk-Through",id:"walk-through",level:3},{value:"Status LEDs",id:"status-leds",level:2},{value:"Blue LED",id:"blue-led",level:3},{value:"Green LED",id:"green-led",level:3}];function d(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.admonition,{type:"tip",children:(0,r.jsxs)(t.p,{children:["For power cycle, LED and button information on the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io",children:"AutoPi"})," ",(0,r.jsx)(t.a,{href:"https://www.autopi.io/hardware/autopi-tmu-cm4",children:"TMU CM4"}),", please see ",(0,r.jsx)(t.a,{href:"/hardware/autopi_tmu_cm4/led-and-button",children:"configuration here"})]})}),"\n",(0,r.jsx)(t.p,{children:"The power management of the device consists of a low- and high-level layer. For further details please see:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"/core/power_management/core-power-low",children:"Low-level"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"/core/power_management/core-power-high",children:"High-level"})}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"power-cycle",children:"Power Cycle"}),"\n",(0,r.jsx)(t.p,{children:"Overall, there are three states that the device can be in:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"On"}),"\n",(0,r.jsx)(t.li,{children:"Sleeping"}),"\n",(0,r.jsx)(t.li,{children:"Hibernating"}),"\n"]}),"\n",(0,r.jsx)(t.h4,{id:"on",children:"On"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"On"})," state is when the device is awake and performing work. It will record data, communicate with the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io/software-platform/cloud-management",children:"Cloud"})," or do whatever it has been configured to do.\nEventually, when the vehicle has turned off, a sleep timer is scheduled that will shut down the device and go to sleep in order to conserve power. This sleep timer puts the device into the ",(0,r.jsx)(t.code,{children:"Sleeping"})," state."]}),"\n",(0,r.jsx)(t.h4,{id:"sleeping",children:"Sleeping"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"Sleeping"})," state is a state where the device is powered off for a certain period of time. Before the device goes to sleep, there is always setup\nan interval until it will wake up again (",(0,r.jsx)(t.a,{href:"/cloud/device_management/advanced_settings/autopi_tmu_cm4/cloud-config-power/#sleep-timer",children:"configuration here"}),"). When the ",(0,r.jsx)(t.a,{href:"/cloud/device_management/advanced_settings/autopi_tmu_cm4/cloud-config-power/#modem",children:(0,r.jsx)(t.code,{children:"Modem > Power Save"})})," option is disabled, the modem is kept powered on while sleeping. This makes it possible to wake the device by sending an SMS to it, if it is within mobile network range."]}),"\n",(0,r.jsxs)(t.p,{children:["There are generally two reasons for a device to go to the ",(0,r.jsx)(t.code,{children:"On"})," state while sleeping:"]}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"The vehicle's engine turns on."})," More precisely, the vehicle's battery voltage raises above a ",(0,r.jsx)(t.a,{href:"/cloud/device_management/advanced_settings/autopi_tmu_cm4/cloud-config-power/#wake-trigger",children:"specified threshold"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"The sleep timer's sleep period passes."})," When the device goes to sleep, a wake timer is being setup based on the inactivity setting."]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"We will take a look at example scenarios which will further describe the power cycle of the device."}),"\n",(0,r.jsx)(t.h4,{id:"hibernating",children:"Hibernating"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"Hibernating"})," state is the last effort the device will do in order to preserve your vehicle's battery. It will shut off almost all\nof the functionalities of the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io",children:"AutoPi"})," leaving only one power-cheap component on - a chip that will detect a raise in the battery's\nvoltage so that it can trigger an ",(0,r.jsx)(t.code,{children:"On"})," state. This will happen when the vehicle is powered on, so this is the moment the battery will\nstart to charge up again."]}),"\n",(0,r.jsx)(t.h3,{id:"walk-through",children:"Walk-Through"}),"\n",(0,r.jsx)(t.p,{children:"Let us now walk through an example of the power cycle. We will begin with the device being unplugged and the vehicle's engine not running.\nIf we plug in a device in the vehicle's OBD-II port the following steps will occur:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"The device will start booting"}),"\n",(0,r.jsxs)(t.li,{children:["After some time, bootup process will finish and device will appear online on the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io/software-platform/cloud-management",children:"Cloud"})]}),"\n",(0,r.jsx)(t.li,{children:"A sleep timer will be setup (that will expire after 5 minutes by default)"}),"\n",(0,r.jsxs)(t.li,{children:["When the sleep timer expires, three things will happen:","\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"A wake up timer will be setup on the hardware level"}),"\n",(0,r.jsxs)(t.li,{children:["The device will attempt to upload pending data to the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io/software-platform/cloud-management",children:"Cloud"})]}),"\n",(0,r.jsx)(t.li,{children:"The device will start its shutdown procedure"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.li,{children:"Device is now sleeping"}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"By default, a sleep timer will introduce a wake-up timer that is in 2 hours after the device goes to sleep. So let's now take a look\nat what happens with this:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"Wake-up timer expires"}),"\n",(0,r.jsx)(t.li,{children:"Device will start its boot process"}),"\n",(0,r.jsxs)(t.li,{children:["After boot, device will appear online on the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io/software-platform/cloud-management",children:"Cloud"})]}),"\n",(0,r.jsx)(t.li,{children:"A new sleep timer will be setup (5 minutes by default)"}),"\n",(0,r.jsxs)(t.li,{children:["When the sleep timer expires, three things happen:","\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"A wake up timer will be setup on the hardware level"}),"\n",(0,r.jsxs)(t.li,{children:["The device will attempt to upload any pending data to the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io/software-platform/cloud-management",children:"Cloud"})]}),"\n",(0,r.jsx)(t.li,{children:"The device will start its shutdown procedure"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.li,{children:"Device is now sleeping"}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["It is more or less the same procedure. This means that by default, your device will wake up every two hours, setup a sleep timer for 5\nminutes and go back to sleep. In the time that the device is ",(0,r.jsx)(t.code,{children:"On"})," it will try to read data off of the CAN bus from the vehicle, record\nit and report any data or events it needs to report to the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io/software-platform/cloud-management",children:"Cloud"}),". Now, what happens if the vehicle is being driven? Let's assume that\nthe device is asleep at the moment that the engine of the vehicle gets turned on. Here's what will happen:"]}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"The STN chip will detect the higher voltage reading"}),"\n",(0,r.jsx)(t.li,{children:"The STN chip will send a wake-up request to the device"}),"\n",(0,r.jsx)(t.li,{children:"The device will boot up"}),"\n",(0,r.jsxs)(t.li,{children:["After boot, the device will appear online on the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io/software-platform/cloud-management",children:"Cloud"})]}),"\n",(0,r.jsx)(t.li,{children:"Device will detect CAN bus traffic, more specifically RPM values (only works by default on standard ICE vehicles)"}),"\n",(0,r.jsxs)(t.li,{children:["The RPM values will trigger an event called ",(0,r.jsx)(t.code,{children:"vehicle/engine/running"})]}),"\n",(0,r.jsx)(t.li,{children:"All sleep timers are cleared and sleep timers are no longer allowed to be set"}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"Almost the same process will occur if the device is already awake with the exception that it won't need to actually boot up again.\nInstead, the device will stay awake, current sleep timers will be cleared and new sleep timers won't be able to be set."}),"\n",(0,r.jsxs)(t.p,{children:["So now you may be wondering, when exactly does the device go into hibernation, or maybe what even is the hibernation state?\nHibernation is a state where the device sees that the battery is very low on power and will shut down completely, leaving only\na very power-cheap device which will wake the device up again when the battery level raises to normal values. This mode is necessary\nas without it, the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io",children:"AutoPi"})," can potentially drain the battery so low that the vehicle won't be able to start up the next time, or\neven worse - permanently damage the battery. So, in essence, hibernation is a last resort effort of the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io",children:"AutoPi"})," to protect the battery\nof the vehicle."]}),"\n",(0,r.jsxs)(t.p,{children:["There are two settings that you can tweak on the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io/software-platform/cloud-management",children:"Cloud"})," in the Advanced > Settings > Power section: ",(0,r.jsx)(t.code,{children:"Critical Level"})," and ",(0,r.jsx)(t.code,{children:"Safety Cut-Out"}),".\nThey both make the device go to hibernation, however they differ on one key point - Critical Level will still shut down the device\ngracefully, while Safety Cut-Out will essentially pull the plug on it. The difference is that with a graceful shutdown the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io/software-platform/cloud-management",children:"Cloud"})," will\n(",(0,r.jsx)(t.em,{children:"likely"}),"*) receive an event that will be reported. With Safety Cut-out, this won't happen, there will only be a notification the next\ntime the device gets online."]}),"\n",(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsxs)(t.p,{children:["*",(0,r.jsx)(t.em,{children:"likely"})," - If the device doesn't have access to the internet for whatever reason (no WiFi connection, no 4G/LTE enabled, or there is no\ncoverage at the current moment) the event will not be sent to the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io/software-platform/cloud-management",children:"Cloud"})," even if it went to hibernation due to the Critical Level threshold."]})}),"\n",(0,r.jsxs)(t.p,{children:["As long as the battery doesn't go below the Voltage threshold that are set on those two settings (",(0,r.jsx)(t.code,{children:"Critical Level"})," and ",(0,r.jsx)(t.code,{children:"Safety Cut-Out"}),")\nyour device will wake up occasionally to check up on if it needs to do something or not. If there is nothing to do, it will go back to\nsleep after the sleep timer is triggered."]}),"\n",(0,r.jsx)(t.admonition,{type:"caution",children:(0,r.jsxs)(t.p,{children:["For OBD-II non-compliant vehicles additional configuration may be required to ensure a well-functioning power cycle.\nFor EVs please see this ",(0,r.jsx)(t.a,{href:"/getting_started/electric_vehicles/power-cycle-for-electric-vehicles/",children:"guide"}),"."]})}),"\n",(0,r.jsx)(t.h2,{id:"status-leds",children:"Status LEDs"}),"\n",(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsxs)(t.p,{children:["Status LEDs are only available on the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io",children:"AutoPi"})," Telematics Unit."]})}),"\n",(0,r.jsx)(t.h3,{id:"blue-led",children:"Blue LED"}),"\n",(0,r.jsxs)(t.p,{children:["The blue LED indicates the current state of the ",(0,r.jsx)(t.a,{href:"/core/power_management/core-power-low",children:"low-level "})," SPM system."]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"LED State"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Turned off"}),(0,r.jsxs)(t.td,{children:["SPM is in ",(0,r.jsx)(t.a,{href:"/core/power_management/core-power-low#off",children:"OFF"})," state."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Flashing brightly"}),(0,r.jsxs)(t.td,{children:["SPM is in ",(0,r.jsx)(t.a,{href:"/core/power_management/core-power-low#booting",children:"BOOTING"})," state."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Constantly bright"}),(0,r.jsxs)(t.td,{children:["SPM is in ",(0,r.jsx)(t.a,{href:"/core/power_management/core-power-low#on",children:"ON"})," state."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Breathing effect"}),(0,r.jsxs)(t.td,{children:["SPM is in ",(0,r.jsx)(t.a,{href:"/core/power_management/core-power-low#sleeping",children:"SLEEPING"})," state."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Constantly dimmed"}),(0,r.jsxs)(t.td,{children:["SPM is in ",(0,r.jsx)(t.a,{href:"/core/power_management/core-power-low#hibernating",children:"HIBERNATING"})," state."]})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"green-led",children:"Green LED"}),"\n",(0,r.jsxs)(t.p,{children:["The green LED indicates the current state of the ",(0,r.jsx)(t.a,{href:"/core/power_management/core-power-high",children:"high-level"})," system."]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"LED State"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Turned off"}),(0,r.jsx)(t.td,{children:"Not running or in the process of booting up."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Flashing brightly"}),(0,r.jsxs)(t.td,{children:["Up and running but NOT (yet) connected to the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io/software-platform/cloud-management",children:"Cloud"}),"."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Constantly bright"}),(0,r.jsxs)(t.td,{children:["Up and running and connected to the ",(0,r.jsx)(t.a,{href:"https://www.autopi.io/software-platform/cloud-management",children:"Cloud"}),"."]})]})]})]})]})}function c(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>s});var i=n(96540);const r={},o=i.createContext(r);function l(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);