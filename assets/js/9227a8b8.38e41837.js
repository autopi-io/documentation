(self.webpackChunkdocumentation_2=self.webpackChunkdocumentation_2||[]).push([[3212],{3905:function(e,t,r){"use strict";r.d(t,{Zo:function(){return l},kt:function(){return d}});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var s=n.createContext({}),u=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},l=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),p=u(r),d=o,f=p["".concat(s,".").concat(d)]||p[d]||m[d]||a;return r?n.createElement(f,i(i({ref:t},l),{},{components:r})):n.createElement(f,i({ref:t},l))}));function d(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=p;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:o,i[1]=c;for(var u=2;u<a;u++)i[u]=r[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}p.displayName="MDXCreateElement"},22943:function(e,t,r){"use strict";r.d(t,{$:function(){return o}});var n=r(67294),o=function(e){var t=e.title,r=e.url;return n.createElement(n.Fragment,null,n.createElement("h2",null,"Discussion"),n.createElement("p",null,"If you'd like to discuss this topic with us or other fellow community members, you can do so on our community page dedicated for this guide: ",n.createElement("a",{href:r},t),"."),n.createElement("p",null,"You can also write us an email on ",n.createElement("a",{href:"mailto:support@autopi.io"},"support@autopi.io"),". We usually respond back in 24 hours on working days."))}},62922:function(e,t,r){"use strict";r.r(t),r.d(t,{frontMatter:function(){return s},contentTitle:function(){return u},metadata:function(){return l},toc:function(){return m},default:function(){return d}});var n=r(22122),o=r(19756),a=(r(67294),r(3905)),i=r(22943),c=["components"],s={id:"create-custom-returners",title:"Create Custom Returners"},u=void 0,l={unversionedId:"cloud/device_management/services/create-custom-returners",id:"cloud/device_management/services/create-custom-returners",isDocsHomePage:!1,title:"Create Custom Returners",description:"In this guide we redirect accelerometer data to a file on disk, but the functionality is general,",source:"@site/docs/cloud/device_management/services/create_custom_returners.mdx",sourceDirName:"cloud/device_management/services",slug:"/cloud/device_management/services/create-custom-returners",permalink:"/cloud/device_management/services/create-custom-returners",editUrl:"https://github.com/autopi-io/documentation/edit/master/docs/cloud/device_management/services/create_custom_returners.mdx",tags:[],version:"current",frontMatter:{id:"create-custom-returners",title:"Create Custom Returners"},sidebar:"sidebar",previous:{title:"Introduction",permalink:"/cloud/device_management/services/services-intro"},next:{title:"Create Custom Services",permalink:"/cloud/device_management/services/create-custom-services"}},m=[],p={toc:m};function d(e){var t=e.components,s=(0,o.Z)(e,c);return(0,a.kt)("wrapper",(0,n.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"In this guide we redirect accelerometer data to a file on disk, but the functionality is general,\nand the procedure can also be used for OBD data, GPS data and others."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Start by creating a custom code module of type ",(0,a.kt)("em",{parentName:"p"},"Returner"),". Go to ",(0,a.kt)("strong",{parentName:"p"},"Device")," > ",(0,a.kt)("strong",{parentName:"p"},"Custom Code"),":"),(0,a.kt)("p",{parentName:"li"},(0,a.kt)("img",{alt:"Create custom returner",src:r(31980).Z})," "),(0,a.kt)("p",{parentName:"li"},"This default returner implementation will append results to a file on disk located at\n",(0,a.kt)("inlineCode",{parentName:"p"},"/tmp/returner_data.txt"),". But in reality, it's possible to integrate with any storage system here.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"For the accelerometer service named ",(0,a.kt)("strong",{parentName:"p"},"acc_manager")," register the created custom returner as a\nhook so it can be used in worker workflows. Go to ",(0,a.kt)("strong",{parentName:"p"},"Device")," > ",(0,a.kt)("strong",{parentName:"p"},"Services")," > ",(0,a.kt)("strong",{parentName:"p"},"acc_manager")," >\n",(0,a.kt)("strong",{parentName:"p"},"Hooks")," > ",(0,a.kt)("strong",{parentName:"p"},"Create"),":"),(0,a.kt)("p",{parentName:"li"},"  ",(0,a.kt)("img",{alt:"Register custom returner hook",src:r(67565).Z})," ")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Next, we have to use the registered hook by editing the workflow for the ",(0,a.kt)("strong",{parentName:"p"},"xyz_logger")," worker.\nGo to ",(0,a.kt)("strong",{parentName:"p"},"Device")," > ",(0,a.kt)("strong",{parentName:"p"},"Services")," > ",(0,a.kt)("strong",{parentName:"p"},"acc_manager")," > ",(0,a.kt)("strong",{parentName:"p"},"Workers")," > ",(0,a.kt)("strong",{parentName:"p"},"xyz_logger"),". Here we have\nto change the returner from ",(0,a.kt)("em",{parentName:"p"},"cloud")," to ",(0,a.kt)("em",{parentName:"p"},"my_returner"),":"),(0,a.kt)("p",{parentName:"li"},(0,a.kt)("img",{alt:"Use custom returner in workflow",src:r(11616).Z})," "))),(0,a.kt)("p",null,"When above changes have been successfully synchronised to the device, it will start logging\naccelerometer data to the specified file."),(0,a.kt)("p",null,"When logged onto the device using SSH, it is possible to monitor the data in realtime with the\ncommand:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"tail -f /tmp/returner_data.txt")),(0,a.kt)(i.$,{title:"Redirect logged data and store it in a file (or anywhere)",url:"https://community.autopi.io/t/custom-code-redirect-logged-data-and-store-it-in-a-file-or-anywhere/1521",mdxType:"Discussion"}))}d.isMDXComponent=!0},31980:function(e,t,r){"use strict";t.Z=r.p+"assets/images/create_custom_returner-64c4c4b4262e4f10a572d9db5ef51d2e.png"},67565:function(e,t,r){"use strict";t.Z=r.p+"assets/images/register_custom_returner_hook-cb7d9f599fc54cdf697ccf0808432170.png"},11616:function(e,t,r){"use strict";t.Z=r.p+"assets/images/use_custom_returner_in_workflow-da0d785b567eb92d32651fcd39c88ced.png"}}]);