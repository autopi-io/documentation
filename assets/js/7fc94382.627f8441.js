(self.webpackChunkdocumentation_2=self.webpackChunkdocumentation_2||[]).push([[4423],{3905:function(e,t,a){"use strict";a.d(t,{Zo:function(){return c},kt:function(){return u}});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=p(a),u=r,h=m["".concat(l,".").concat(u)]||m[u]||d[u]||i;return a?n.createElement(h,o(o({ref:t},c),{},{components:a})):n.createElement(h,o({ref:t},c))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},23508:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},toc:function(){return c},default:function(){return m}});var n=a(22122),r=a(19756),i=(a(67294),a(3905)),o=["components"],s={id:"j1939-getting-started-guide",title:"Getting Started"},l=void 0,p={unversionedId:"getting_started/heavy_duty_vehicles/j1939-getting-started-guide",id:"getting_started/heavy_duty_vehicles/j1939-getting-started-guide",isDocsHomePage:!1,title:"Getting Started",description:"This guide will show how to retrieve data from a vehicle supporting the J1939 protocol. To read more background information about J1939 please see the blog post: J1939 Explained",source:"@site/docs/getting_started/heavy_duty_vehicles/j1939_getting_started_guide.md",sourceDirName:"getting_started/heavy_duty_vehicles",slug:"/getting_started/heavy_duty_vehicles/j1939-getting-started-guide",permalink:"/getting_started/heavy_duty_vehicles/j1939-getting-started-guide",editUrl:"https://github.com/autopi-io/documentation/edit/master/docs/getting_started/heavy_duty_vehicles/j1939_getting_started_guide.md",tags:[],version:"current",frontMatter:{id:"j1939-getting-started-guide",title:"Getting Started"},sidebar:"sidebar",previous:{title:"Data Troubleshooting",permalink:"/getting_started/autopi_mini/mini-data-troubleshooting"},next:{title:"Getting Started",permalink:"/getting_started/electric_vehicles/electric-vehicles-intro"}},c=[{value:"Preconditions",id:"preconditions",children:[]},{value:"Check for Broadcast Data",id:"check-for-broadcast-data",children:[]},{value:"Query for Data",id:"query-for-data",children:[]},{value:"Register Vehicle Bus",id:"register-vehicle-bus",children:[]},{value:"Register PID for Request PGN",id:"register-pid-for-request-pgn",children:[]},{value:"Decode Messages (with DBC file)",id:"decode-messages-with-dbc-file",children:[{value:"Create Mapping",id:"create-mapping",children:[]},{value:"Sync DBC File",id:"sync-dbc-file",children:[]},{value:"Test CAN Converter",id:"test-can-converter",children:[]}]},{value:"Setup Loggers",id:"setup-loggers",children:[]}],d={toc:c};function m(e){var t=e.components,s=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,n.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"This guide will show how to retrieve data from a vehicle supporting the J1939 protocol. To read more background information about J1939 please see the blog post: ",(0,i.kt)("a",{parentName:"p",href:"https://www.autopi.io/blog/j1939-explained/"},"J1939 Explained")),(0,i.kt)("h2",{id:"preconditions"},"Preconditions"),(0,i.kt)("p",null,"Before proceeding the AutoPi device must be:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Connected to the vehicle with an appropriate OBD-II adapter cable that connects the vehicles two J1939 CAN bus wires to pin 6 (high) and 14 (low) of the OBD-II connector on the AutoPi device. If you are missing an adapter cable for your specific vehicle please contact ",(0,i.kt)("a",{parentName:"li",href:"mailto:sales@autopi.io"},"sales@autopi.io"),"."),(0,i.kt)("li",{parentName:"ol"},"When initially inserting the device, make sure that the vehicle is powered off."),(0,i.kt)("li",{parentName:"ol"},"Powered on and online in the AutoPi Cloud at ",(0,i.kt)("a",{parentName:"li",href:"https://my.autopi.io"},"https://my.autopi.io"),"."),(0,i.kt)("li",{parentName:"ol"},"Also the ignition of the vehicle must be turned on to ensure the J1939 CAN bus is active.")),(0,i.kt)("h2",{id:"check-for-broadcast-data"},"Check for Broadcast Data"),(0,i.kt)("p",null,"As most J1939 messages are broadcast we start by checking if we can see any data on the CAN bus."),(0,i.kt)("p",null,"On ",(0,i.kt)("a",{parentName:"p",href:"https://my.autopi.io"},"https://my.autopi.io")," go to ",(0,i.kt)("em",{parentName:"p"},"Devices")," > ",(0,i.kt)("em",{parentName:"p"},"Select Device")," > ",(0,i.kt)("em",{parentName:"p"},"CAN Analyzer")," > ",(0,i.kt)("em",{parentName:"p"},"Sniffer"),"."),(0,i.kt)("p",null,"Select one of the following J1939 protocols that fits your vehicle in regards to 11bit or 29bit header:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[41] J1939 (11bit, 250kbps)")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[42] J1939 (29bit, 250kbps)"))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Optional:")," Change the baud rate if predefined value of ",(0,i.kt)("inlineCode",{parentName:"p"},"250000")," is incorrect. ",(0,i.kt)("inlineCode",{parentName:"p"},"500000")," is a typical alternative."),(0,i.kt)("p",null,"Click the ",(0,i.kt)("em",{parentName:"p"},"Sniff")," button to start recording CAN messages sent on the J1939 bus. An example of a recording result is shown in below screenshot."),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The start and end of the recording are indicated audibly with loud beep sounds played by the AutoPi device."))),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Example"),":"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"j1939_can_sniffer",src:a(59587).Z})),(0,i.kt)("p",null,"If no data is returned, try:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Change the protocol and/or baud rate combinations."),(0,i.kt)("li",{parentName:"ol"},"Increase the recording duration from default ",(0,i.kt)("inlineCode",{parentName:"li"},"1")," to ",(0,i.kt)("inlineCode",{parentName:"li"},"10")," seconds."),(0,i.kt)("li",{parentName:"ol"},"Continue to the next section describing how to query for data.")),(0,i.kt)("h2",{id:"query-for-data"},"Query for Data"),(0,i.kt)("p",null,"Some data is only available on request. This means a J1939 request message must be sent in order to get a data response. This can be done using the PID tester tool."),(0,i.kt)("p",null,"In the ",(0,i.kt)("em",{parentName:"p"},"CAN Analyzer")," select the ",(0,i.kt)("em",{parentName:"p"},"PID Tester")," tab."),(0,i.kt)("p",null,"First the J1939 protocol and baud rate must be specified in the same way as described previously."),(0,i.kt)("p",null,"Next the J1939 request message must be specififed. It consists of a header and a data part. "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Header:")," ",(0,i.kt)("inlineCode",{parentName:"p"},"18 EA 00 F9")," is broken down into:"),(0,i.kt)("ul",{parentName:"blockquote"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"18")," contains priority of 6."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"EA 00")," is PGN 59904 (Request PGN)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"F9")," is source address 249 (Service Tool).")),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Data:")," ",(0,i.kt)("inlineCode",{parentName:"p"},"00 C1 00")," is the specific PGN that is requested. In this example PGN 49408 (Diagnostic Readiness 2).")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Example"),":"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"j1939_pgn_query",src:a(54986).Z})," "),(0,i.kt)("p",null,"In above screenshot we query PGN 61444 (Electronic Engine Controller 1) which among other values contains SPN 190 (Engine Speed)."),(0,i.kt)("h2",{id:"register-vehicle-bus"},"Register Vehicle Bus"),(0,i.kt)("p",null,"Once a J1939 bus has been identified and tested, it is recommended to register it on the vehicle's profile."),(0,i.kt)("p",null,"Go to ",(0,i.kt)("em",{parentName:"p"},"Devices")," > ",(0,i.kt)("em",{parentName:"p"},"Select Device")," > ",(0,i.kt)("em",{parentName:"p"},"Settings")," > ",(0,i.kt)("em",{parentName:"p"},"Vehicles Editor")," and click on ",(0,i.kt)("em",{parentName:"p"},"Create")," button below ",(0,i.kt)("em",{parentName:"p"},"CAN Buses"),". Fill in the relevant values for name, protocol and baud rate."),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Example"),":"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"create_j1939_vehicle_bus",src:a(55169).Z})),(0,i.kt)("h2",{id:"register-pid-for-request-pgn"},"Register PID for Request PGN"),(0,i.kt)("p",null,"This section may be skipped if you only receive broadcast J1939 messages. But if you need to query for a specific PGN\nit is recommended to register the request PGN as a PID in the ",(0,i.kt)("em",{parentName:"p"},"OBD Library"),". It can then later be used to easily set up loggers."),(0,i.kt)("p",null,"Go to ",(0,i.kt)("em",{parentName:"p"},"OBD Library")," > ",(0,i.kt)("em",{parentName:"p"},"Create")," > ",(0,i.kt)("em",{parentName:"p"},"PID"),"."),(0,i.kt)("p",null,"Enter the informations previously verified using the ",(0,i.kt)("em",{parentName:"p"},"PID Tester"),"."),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Example"),":"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"create_pid_for_j1939_request_pgn",src:a(24054).Z})),(0,i.kt)("h4",{id:"pid-details"},"PID Details"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Name:")," Short name of the PGN requested."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Description:")," Optional description of the PGN requested."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Mode:")," Hexadecimal value ",(0,i.kt)("inlineCode",{parentName:"p"},"00")," is specified here."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Code:")," The hexadecimal representation of the requsted PGN number 61444 (Electronic Engine Controller 1)."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Header:")," The header to request a PGN:"),(0,i.kt)("ul",{parentName:"blockquote"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"18")," contains priority of 6."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"EA 00")," is PGN 59904 (Request PGN)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"F9")," is source address 249 (Service Tool)."))),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"It is recommended to specify how many messages/frames are expected to be returned by the query. This is done by unfolding the section ",(0,i.kt)("em",{parentName:"p"},"Enhanced PID")," and entering the number of messages under ",(0,i.kt)("em",{parentName:"p"},"Frames"),". This helps reduce the total query time (better performance) because the waiting timeout for the last message is skipped."))),(0,i.kt)("h4",{id:"used-by-vehicles"},"Used by Vehicle(s)"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Vehicle Bus(es):"),"  Specify which bus(es) the PID is to be associated with. The previously created J1939 bus is selected.")),(0,i.kt)("h2",{id:"decode-messages-with-dbc-file"},"Decode Messages (with DBC file)"),(0,i.kt)("p",null,"After receiving the raw J1939 CAN messages they must be decoded to get the actual measurement values. This can be done using the built-in CAN database functionality."),(0,i.kt)("p",null,"The CAN database contains definitions of how the individual CAN messages are structured. Each CAN message can consist of one or more CAN signals, each of which typically contains a single measurement value (eg. temperature, speed, RPM or the like)."),(0,i.kt)("p",null,"As an exmaple, the J1939 PGN 61444 (Electronic Engine Controller 1) contains 8 SPNs in total. It can be mapped to a CAN message with 8 CAN signals as shown below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PGN 61444 (Electronic Engine Controller 1)                            ---\x3e  CAN message\n  SPN 899 (Engine Torque Mode)                                        ---\x3e    CAN signal #1\n  SPN 899 (Engine Torque Mode)                                        ---\x3e    CAN signal #2\n  SPN 4154 (Actual Engine - Percent Torque)                           ---\x3e    CAN signal #3\n  SPN 512 (Driver's Demand Engine - Percent Torque)                   ---\x3e    CAN signal #4\n  SPN 513 (Actual Engine - Percent Torque)                            ---\x3e    CAN signal #5\n  SPN 190 (Engine Speed)                                              ---\x3e    CAN signal #6\n  SPN 1483 (Source Address of Controlling Device for Engine Control)  ---\x3e    CAN signal #7\n  SPN 1675 (Engine Starter Mode)                                      ---\x3e    CAN signal #8\n  SPN 2432 (Engine Demand \u2013 Percent Torque)                           ---\x3e    CAN signal #9\n")),(0,i.kt)("p",null,"When all (or only a few selected) CAN messages have be defined they will need to be synchronized to the AutoPi device and stored in the form of a DBC file. The synchronization is handled automatically by to AutoPi Cloud management system. Using this DBC file, the AutoPi device can decode raw CAN messages into readable measurement values. The decoded data can then be uploaded to the AutoPi Cloud, stored locally or sent to any custom endpoint."),(0,i.kt)("h3",{id:"create-mapping"},"Create Mapping"),(0,i.kt)("p",null,"To create a mapping for a CAN message to be be decoded go to ",(0,i.kt)("em",{parentName:"p"},"OBD Library")," > ",(0,i.kt)("em",{parentName:"p"},"Create")," > ",(0,i.kt)("em",{parentName:"p"},"CAN"),"."),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Example"),":"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"create_j1939_can_message",src:a(72716).Z})," "),(0,i.kt)("p",null,"In above screenshot, we register a CAN message mapping for PGN 61444 (Electronic Engine Controller 1):"),(0,i.kt)("h4",{id:"can-message"},"CAN Message"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Name:")," Short name to identify the CAN message."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Description:")," Optional description of the CAN message."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Header:")," CAN message header for PGN 61444:"),(0,i.kt)("ul",{parentName:"blockquote"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"8C")," contains priority of 6 but has no actual significance."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"F004")," is the hexadecimal representation of PGN number 61444."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"FE")," is source address 254 (Null Address) but has no actual significance.")),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Bytes:")," 8 is the number of data bytes that the CAN message contains."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Sender:")," Identifier of the ECU that sent the CAN message. Enter ",(0,i.kt)("inlineCode",{parentName:"p"},"XXX")," or similar if unknown.")),(0,i.kt)("h4",{id:"can-signal-1"},"CAN Signal #1"),(0,i.kt)("p",null,"In the above screenshot we only show how to map SPN 190 (Engine Speed) but the procedure the same when adding more."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Name:")," Short name to identify the CAN signal."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Description:")," Optional description of the CAN signal."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Endian:")," Sequence of bytes is little-endian - least significant bits first."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Start:")," Bitwise start index of the CAN signal value within the data part of the CAN message. When it comes to big-endian indexing is straightforward, but for little-endian it is more complex."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Length:")," Bit length of the CAN signal value."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Sign:")," Unsigned integer value - no negative values."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Factor:")," A factor of ",(0,i.kt)("inlineCode",{parentName:"p"},"0.125")," to be multiplied by the value in order to get the actual measurement value."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Offset:")," No offset to be added to the value."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Unit:")," Unit of the value is RPM (Revolutions per minute)."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Min:")," The maximum possible value is undefined."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Max:")," The minimum possible value is undefined."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Receivers:")," Identifiers for ECUs that use the signal value.")),(0,i.kt)("h4",{id:"used-by-vehicles-1"},"Used by Vehicle(s)"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Vehicle Bus(es):"),"  Specify which bus(es) the CAN message is to be associated with. The previously created J1939 bus is selected.")),(0,i.kt)("h3",{id:"sync-dbc-file"},"Sync DBC File"),(0,i.kt)("p",null,"After the CAN message has been created, it must be synchronized to the AutoPi device. This is done in the same way as all other changes; applied immediately on request if the device is online or queued and applied the next time the device is back online."),(0,i.kt)("p",null,"When synchronizing, the CAN messages are stored in one or more DBC files located on the file system below the path:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"/opt/autopi/obd/can/db/protocol_<ID>.dbc\n")),(0,i.kt)("p",null,"A separate DBC file is created on the device for each associated vehicle bus protocol.\nIn the above example, protocol ",(0,i.kt)("inlineCode",{parentName:"p"},"[42] J1939 (29bit, 250kbps)")," is used. Therefore, the synchronized DBC file will be found at: ",(0,i.kt)("inlineCode",{parentName:"p"},"/opt/autopi/obd/can/db/protocol_42.dbc")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"As default, all created CAN messages and associated CAN signals are synchronized to the DBC file. But if one or more CAN signals\nare used in loggers only the used CAN signals and CAN messages are included in the DBC file."))),(0,i.kt)("h3",{id:"test-can-converter"},"Test CAN Converter"),(0,i.kt)("p",null,"To easily test CAN message conversion with a DBC file, the following terminal command can be executed. It performs a single workflow that queries a PGN and then converts the raw response message using the DBC file."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"obd.manage run handler=\"query\" args=\"['EEC1']\" kwargs=\"{'mode': '00', 'pid': 'F004', 'header': '18EA00F9', 'force': true}\" converter=\"can\"\n")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Example"),":"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"create_pid_for_j1939_request_pgn",src:a(87032).Z})),(0,i.kt)("h4",{id:"command-breakdown"},"Command Breakdown"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"obd.manage"))," is the ",(0,i.kt)("a",{parentName:"p",href:"/core/commands/core-commands-obd/#obdmanage"},"command")," to execute."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"run"))," a ",(0,i.kt)("a",{parentName:"p",href:"/core/services/core-services-intro/#workflows"},"workflow")," directly."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},'handler="query"'))," specifies the handler of the workflow to be called."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},'args="',"['EEC1']",'"'))," specifices the arguments of the handler. The value consists of an embedded JSON array."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"kwargs=\"{'mode': '00', 'pid': 'F004', 'header': '18EA00F9', 'force': true}\""))," specifices the keyword arguments of the handler. The value consists of an embedded JSON dictionary."),(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},'converter="can"'))," specifies a converter in the workflow to be called after the handler. Here we use the ",(0,i.kt)("a",{parentName:"p",href:"/core/services/core-services-obd-manager/#can"},"CAN")," converter.")),(0,i.kt)("h2",{id:"setup-loggers"},"Setup Loggers"),(0,i.kt)("p",null,"To receive the J1939 data in the cloud, loggers must first be set up on the device. Go to ",(0,i.kt)("em",{parentName:"p"},"Device")," > ",(0,i.kt)("em",{parentName:"p"},"Loggers")," and create loggers\nfor the respective PIDs and or CAN messages. After a logger has been created, it must be synchronized to the AutoPi device, just like any other change."))}m.isMDXComponent=!0},72716:function(e,t,a){"use strict";t.Z=a.p+"assets/images/create_j1939_can_message-0fd78e4fc11b0da14116719737494341.png"},55169:function(e,t,a){"use strict";t.Z=a.p+"assets/images/create_j1939_vehicle_bus-ebc54f7532d56110774f4453898f6324.png"},24054:function(e,t,a){"use strict";t.Z=a.p+"assets/images/create_pid_for_j1939_request_pgn-97d849bf809f741e91e7fd219dbd74af.png"},59587:function(e,t,a){"use strict";t.Z=a.p+"assets/images/j1939_can_sniffer-56f576c4f54561ce8bdba4066d0070a3.png"},54986:function(e,t,a){"use strict";t.Z=a.p+"assets/images/j1939_pgn_query-5a2ba34e5914a0b2d75c7909254402b3.png"},87032:function(e,t,a){"use strict";t.Z=a.p+"assets/images/run_j1939_query_workflow-0ac15c9112dc82e5d84988f18fef930d.png"}}]);