"use strict";(self.webpackChunkdocumentation_2=self.webpackChunkdocumentation_2||[]).push([[6318],{28453:(e,t,n)=>{n.d(t,{R:()=>d,x:()=>r});var i=n(96540);const o={},s=i.createContext(o);function d(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),i.createElement(s.Provider,{value:t},e.children)}},58162:(e,t,n)=>{n.d(t,{A:()=>d});n(96540);const i="homeGrid_MM9h",o="cardGrid_IPp8";var s=n(74848);const d=e=>{let{children:t,home:n=!1}=e;return(0,s.jsx)("div",{className:n?i:o,children:t})}},59344:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"developer_guides/setting-up-doip","title":"Setting up DoIP","description":"The DoIP solution described here only works with the AutoPi TMU CM4 and newer editions.","source":"@site/docs/developer_guides/setting_up_doip.md","sourceDirName":"developer_guides","slug":"/developer_guides/setting-up-doip","permalink":"/developer_guides/setting-up-doip","draft":false,"unlisted":false,"editUrl":"https://github.com/autopi-io/documentation/edit/master/docs/developer_guides/setting_up_doip.md","tags":[],"version":"current","frontMatter":{"id":"setting-up-doip","title":"Setting up DoIP"},"sidebar":"sidebar","previous":{"title":"Guides Intro","permalink":"/developer_guides/"},"next":{"title":"Enabling Bluetooth - Using bluepy with AutoPi Edge Devices","permalink":"/developer_guides/how-to-use-bluepy-with-autopi-edge-devices"}}');var o=n(74848),s=n(28453),d=n(29030);n(58162);const r={id:"setting-up-doip",title:"Setting up DoIP"},c=void 0,a={},h=[{value:"Introduction",id:"introduction",level:2},{value:"Contents",id:"contents",level:2},{value:"Ethernet pin assignment of the OBD-II connector",id:"ethernet-pin-assignment-of-the-obd-ii-connector",level:2},{value:"DoIP main pinout",id:"doip-main-pinout",level:3},{value:"DoIP alternative pinout",id:"doip-alternative-pinout",level:3},{value:"Controlling the DoIP port",id:"controlling-the-doip-port",level:3},{value:"Using the DoIP software",id:"using-the-doip-software",level:2},{value:"Enable DoIP on your AutoPi device",id:"enable-doip-on-your-autopi-device",level:3},{value:"DoIP activation",id:"doip-activation",level:3},{value:"Steps to activate the DoIP interface:",id:"steps-to-activate-the-doip-interface",level:4}];function l(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(t.admonition,{title:"Before proceeding with the install",type:"caution",children:[(0,o.jsxs)(t.p,{children:["The DoIP solution described here only works with the ",(0,o.jsx)(t.a,{href:"https://www.autopi.io",children:"AutoPi"})," ",(0,o.jsx)(t.a,{href:"https://www.autopi.io/hardware/autopi-tmu-cm4",children:"TMU CM4"})," and newer editions."]}),(0,o.jsx)(t.p,{children:"When installed, the Ethernet port on the AutoPi device will internally be used for DoIP. Do not connect anything to the Ethernet port."}),(0,o.jsx)(t.p,{children:"Never install the upgraded device in a vehicle that does not support DoIP. Using an Ethernet based protocol in a vehicle that only supports CAN can affect the performance of the vehicle."})]}),"\n",(0,o.jsx)(t.h2,{id:"introduction",children:"Introduction"}),"\n",(0,o.jsx)(t.p,{children:"DoIP is a modern protocol used in the automotive industry for diagnostics and communication between vehicle components and external diagnostic equipment. This technology plays a crucial role in diagnosing and maintaining vehicles, ensuring they operate efficiently and safely.\nAs vehicles become more connected and complex, the need for advanced diagnostic capabilities increases. DoIP provides a robust framework that allows for faster, more reliable data transmission compared to older protocols."}),"\n",(0,o.jsx)(t.h2,{id:"contents",children:"Contents"}),"\n",(0,o.jsxs)(t.p,{children:["This guide covers configuring Diagnostics over IP on the AutoPi ",(0,o.jsx)(t.a,{href:"https://www.autopi.io/hardware/autopi-tmu-cm4/",children:"TMU CM4"})," or ",(0,o.jsx)(t.a,{href:"https://www.autopi.io/hardware/autopi-canfd-pro/",children:"CAN-FD Pro"})," devices. Paired with the AutoPi ",(0,o.jsx)(t.a,{href:"https://shop.autopi.io/products/doip-hat-v1-3",children:"DoIP HAT"}),", these devices can be upgraded to support DoIP. See this guide on how to install the ",(0,o.jsx)(t.a,{href:"/hardware/accessories/doip-install/",children:(0,o.jsx)(t.code,{children:"DoIP HAT"})}),". It's also possible to order the device pre-installed with the DoIP Solution."]}),"\n",(0,o.jsx)(t.h2,{id:"ethernet-pin-assignment-of-the-obd-ii-connector",children:"Ethernet pin assignment of the OBD-II connector"}),"\n",(0,o.jsx)(t.p,{children:"After installing the DoIP HAT your AutoPi device is capeable of communication over an Ethernet based protocol instead of a CAN based protocol. This is a protocol used in some newer vehicles. The standard pinout then changes in the 16 pin OBD-II connector."}),"\n",(0,o.jsx)(t.p,{children:"After the upgrade, four pins are used for Ethernet communication and one pin is used for DoIP activation. Two different DoIP pinout configurations are supported by the AutoPi HAT. Only the Ethernet Rx lines change places between the two configurations."}),"\n",(0,o.jsx)(t.h3,{id:"doip-main-pinout",children:"DoIP main pinout"}),"\n",(0,o.jsx)("p",{align:"center",children:(0,o.jsx)("img",{src:(0,d.Ay)("img/guides/doip_main_pinout.jpg"),alt:"DoIP Main pinout",width:"600"})}),"\n",(0,o.jsxs)(t.table,{children:[(0,o.jsx)(t.thead,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.th,{children:(0,o.jsx)(t.strong,{children:"OBD pinout"})}),(0,o.jsx)(t.th,{children:(0,o.jsx)(t.strong,{children:"DoIP usage"})})]})}),(0,o.jsxs)(t.tbody,{children:[(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Pin 3"}),(0,o.jsx)(t.td,{children:"Ethernet Rx (+)"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Pin 11"}),(0,o.jsx)(t.td,{children:"Ethernet Rx (-)"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Pin 12"}),(0,o.jsx)(t.td,{children:"Ethernet Tx (+)"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Pin 13"}),(0,o.jsx)(t.td,{children:"Ethernet Tx (-)"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Pin 8"}),(0,o.jsx)(t.td,{children:"DoIP Activation"})]})]})]}),"\n",(0,o.jsx)(t.h3,{id:"doip-alternative-pinout",children:"DoIP alternative pinout"}),"\n",(0,o.jsx)("p",{align:"center",children:(0,o.jsx)("img",{src:(0,d.Ay)("img/guides/doip_alt_pinout.jpg"),alt:"DoIP Alternative pinout",width:"600"})}),"\n",(0,o.jsxs)(t.table,{children:[(0,o.jsx)(t.thead,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.th,{children:(0,o.jsx)(t.strong,{children:"OBD pinout"})}),(0,o.jsx)(t.th,{children:(0,o.jsx)(t.strong,{children:"DoIP usage"})})]})}),(0,o.jsxs)(t.tbody,{children:[(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Pin 1"}),(0,o.jsx)(t.td,{children:"Ethernet Rx (+)"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Pin 9"}),(0,o.jsx)(t.td,{children:"Ethernet Rx (-)"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Pin 12"}),(0,o.jsx)(t.td,{children:"Ethernet Tx (+)"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Pin 13"}),(0,o.jsx)(t.td,{children:"Ethernet Tx (-)"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Pin 8"}),(0,o.jsx)(t.td,{children:"DoIP Activation"})]})]})]}),"\n",(0,o.jsx)(t.h3,{id:"controlling-the-doip-port",children:"Controlling the DoIP port"}),"\n",(0,o.jsx)(t.p,{children:"Through the AutoPi Core software, it is possible to control the pinout configuration to be used."}),"\n",(0,o.jsx)(t.h2,{id:"using-the-doip-software",children:"Using the DoIP software"}),"\n",(0,o.jsxs)(t.p,{children:["The AutoPi DoIP integration is based on the ",(0,o.jsx)(t.a,{href:"https://github.com/autopi-io/py-udsoncan",children:"udsoncan library"}),". The integration implements all the services and helper classes from the ",(0,o.jsx)(t.a,{href:"https://udsoncan.readthedocs.io/en/latest/",children:"library"})," and thereby also support UDS (Unified Diagnostic Services)."]}),"\n",(0,o.jsx)(t.h3,{id:"enable-doip-on-your-autopi-device",children:"Enable DoIP on your AutoPi device"}),"\n",(0,o.jsx)(t.p,{children:"Before you are able to fully use the DoIP software you need to set up some settings on your AutoPi device."}),"\n",(0,o.jsx)(t.p,{children:"Steps to get into advanced settings for DoIP:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Go to the Devices section in the menu."}),"\n",(0,o.jsx)(t.li,{children:"Select the device you want to work with."}),"\n",(0,o.jsx)(t.li,{children:"Click on Advanced settings."}),"\n",(0,o.jsx)(t.li,{children:"Click on Doip."}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"DoIP Advanced settings",src:n(82512).A+"",width:"1365",height:"1217"})}),"\n",(0,o.jsx)(t.p,{children:"If you want to enable DoIP on your Autopi device you will need to configure these fields:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.strong,{children:"Default Pin Setup"})," - this setting changes the setup of the pins. You can read more about ",(0,o.jsx)(t.a,{href:"https://docs.autopi.io/developer_guides/setting-up-doip/#doip-main-pinout",children:"DoIP main pinout"})," and ",(0,o.jsx)(t.a,{href:"https://docs.autopi.io/developer_guides/setting-up-doip/#doip-alternative-pinout",children:"DoIP alternative pinout"})," in this guide above. By default this setting is set to main pinout as that one is used more frequently."]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.strong,{children:"Enabled"})," - this setting allow you to enable the DOIP UDS service. By default it is disabled but if you want to start using DoIP, enable it here."]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.strong,{children:"Host"})," - specify the hostname or IP of the TCP endpoint of the vehicle to connect to."]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.strong,{children:"Port"})," - specify the port number of the TCP endpoint. The default value is set to ",(0,o.jsx)(t.code,{children:"13400"}),". You can however change this if the port number is different for your endpoint."]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.strong,{children:"Timeout"})," - timeout of the TCP connection. The default value is set to ",(0,o.jsx)(t.code,{children:"0.1"})," and should be changed only if you experience problems with connection timeouts."]}),"\n"]}),"\n",(0,o.jsx)(t.h3,{id:"doip-activation",children:"DoIP activation"}),"\n",(0,o.jsx)(t.admonition,{type:"note",children:(0,o.jsx)(t.p,{children:"This activation needs to be set up every time the device boots up."})}),"\n",(0,o.jsx)(t.p,{children:"After you have finished setting up the Advanced Settings for your device, you will need to run a command to set the DoIP activation pin high. This will signal to the car that the DoIP connection should be made active."}),"\n",(0,o.jsx)(t.p,{children:"The DoIP HAT works in conjunction with specific software components on the AutoPi device:\u200b"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"doip_manager"}),": A background service managed through the AutoPi Cloud that handles DoIP communication.\u200b"]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"doip"}),": A command module that allow users to manage the DoIP connection and perform diagnostics using UDS.\u200b"]}),"\n"]}),"\n",(0,o.jsx)(t.h4,{id:"steps-to-activate-the-doip-interface",children:"Steps to activate the DoIP interface:"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsxs)(t.li,{children:["Activate the DoIP interface by running the command: ",(0,o.jsx)(t.code,{children:"doip.interface activate"})]}),"\n",(0,o.jsxs)(t.li,{children:["Connect the DoIP endpoint of the vehicle by running the command: ",(0,o.jsx)(t.code,{children:"doip.interface connect"})]}),"\n",(0,o.jsxs)(t.li,{children:["Get more information about available UDS commands by running: ",(0,o.jsx)(t.code,{children:"doip.uds help"})]}),"\n",(0,o.jsxs)(t.li,{children:["Once you have found the UDS command you want to use, you can run the additional help command to receive more information, for example: ",(0,o.jsx)(t.code,{children:"doip.uds help change_session"})]}),"\n",(0,o.jsxs)(t.li,{children:["Finally you can run an UDS command like this: ",(0,o.jsx)(t.code,{children:"doip.uds change_session 1"})]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["You can read about more commands in our ",(0,o.jsx)(t.a,{href:"https://docs.autopi.io/core/commands/core-commands-doip/",children:"DoIP commands guide"}),"."]})]})}function u(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},82512:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/doip_advanced_settings-a92cb4ef94b9a38b0f675d82ae1b2ac6.png"}}]);